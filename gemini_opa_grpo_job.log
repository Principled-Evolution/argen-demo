2025-04-24 14:57:07,958 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 14:57:07,959 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 14:57:07,960 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 14:57:07,960 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 14:57:07,960 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 14:57:07,961 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 14:57:07,961 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 14:57:07,961 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 14:57:07,962 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 14:57:07,962 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 14:57:07,963 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 14:57:07,963 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 14:57:07,963 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 14:57:07,963 - gemini_opa_grpo_job - INFO - GRPO configuration created with 28197 bytes of code
2025-04-24 14:57:07,964 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 14:57:11,890 - gemini_opa_grpo_job - ERROR - Error connecting to Predibase: 'Predibase' object has no attribute 'user'
2025-04-24 14:57:11,890 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: 'Predibase' object has no attribute 'user'
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 367, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 233, in submit_grpo_job
    logger.info(f"Connected to Predibase as {pb.user}")
                                             ^^^^^^^
AttributeError: 'Predibase' object has no attribute 'user'
2025-04-24 14:57:55,950 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 14:57:55,950 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 14:57:55,951 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 14:57:55,951 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 14:57:55,952 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 14:57:55,953 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 14:57:55,953 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 14:57:55,954 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 14:57:55,954 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 14:57:55,955 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 14:57:55,955 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 14:57:55,955 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 14:57:55,955 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 14:57:55,956 - gemini_opa_grpo_job - INFO - GRPO configuration created with 28197 bytes of code
2025-04-24 14:57:55,956 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 14:58:01,489 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 14:58:02,365 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: gradient_accumulation_steps'}
2025-04-24 14:58:02,365 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: gradient_accumulation_steps'}
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 367, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 240, in submit_grpo_job
    job = pb.finetuning.jobs.create(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/resources/finetuning_jobs.py", line 55, in create
    job_resp = self._client.http_post(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 166, in http_post
    return _to_json(do())
           ^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 213, in _to_json
    raise RuntimeError(
RuntimeError: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: gradient_accumulation_steps'}
2025-04-24 14:58:45,721 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 14:58:45,721 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 14:58:45,722 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 14:58:45,722 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 14:58:45,722 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 14:58:45,723 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 14:58:45,723 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 14:58:45,723 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 14:58:45,724 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 14:58:45,724 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 14:58:45,725 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 14:58:45,726 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 14:58:45,726 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 14:58:45,726 - gemini_opa_grpo_job - INFO - GRPO configuration created with 28197 bytes of code
2025-04-24 14:58:45,726 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 14:58:49,623 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 14:58:50,546 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: lora_r'}
2025-04-24 14:58:50,546 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: lora_r'}
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 364, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 237, in submit_grpo_job
    job = pb.finetuning.jobs.create(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/resources/finetuning_jobs.py", line 55, in create
    job_resp = self._client.http_post(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 166, in http_post
    return _to_json(do())
           ^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 213, in _to_json
    raise RuntimeError(
RuntimeError: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: lora_r'}
2025-04-24 14:59:31,141 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 14:59:31,141 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 14:59:31,142 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 14:59:31,143 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 14:59:31,143 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 14:59:31,143 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 14:59:31,143 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 14:59:31,144 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 14:59:31,144 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 14:59:31,144 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 14:59:31,145 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 14:59:31,145 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 14:59:31,145 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 14:59:31,145 - gemini_opa_grpo_job - INFO - GRPO configuration created with 28197 bytes of code
2025-04-24 14:59:31,146 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 14:59:34,910 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 14:59:35,720 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
2025-04-24 14:59:35,720 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 355, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 228, in submit_grpo_job
    job = pb.finetuning.jobs.create(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/resources/finetuning_jobs.py", line 55, in create
    job_resp = self._client.http_post(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 166, in http_post
    return _to_json(do())
           ^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 213, in _to_json
    raise RuntimeError(
RuntimeError: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
2025-04-24 14:59:43,363 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 14:59:43,363 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 14:59:43,364 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 14:59:43,364 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 14:59:43,364 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 14:59:43,365 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 14:59:43,365 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 14:59:43,366 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 14:59:43,366 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 14:59:43,366 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 14:59:43,367 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 14:59:43,367 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 14:59:43,367 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 14:59:43,367 - gemini_opa_grpo_job - INFO - GRPO configuration created with 28197 bytes of code
2025-04-24 14:59:43,368 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 14:59:47,255 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 14:59:48,113 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
2025-04-24 14:59:48,113 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 355, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 228, in submit_grpo_job
    job = pb.finetuning.jobs.create(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/resources/finetuning_jobs.py", line 55, in create
    job_resp = self._client.http_post(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 166, in http_post
    return _to_json(do())
           ^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 213, in _to_json
    raise RuntimeError(
RuntimeError: Bad request. Response status code 400. Error: {'message': 'Invalid finetuning configuration: Unsupported parameter: method'}
2025-04-24 15:01:52,585 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 15:01:52,585 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 15:01:52,586 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 15:01:52,586 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 15:01:52,587 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 15:01:52,587 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 15:01:52,587 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 15:01:52,588 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 15:01:52,588 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 15:01:52,588 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 15:01:52,589 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 15:01:52,589 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 15:01:52,589 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 15:01:55,135 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 353, in main
    config = create_grpo_config(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 172, in create_grpo_config
    reward_fns_config = RewardFunctionsConfig(
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
2025-04-24 15:02:04,319 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 15:02:04,320 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 15:02:04,320 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 15:02:04,321 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 15:02:04,321 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 15:02:04,321 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 15:02:04,322 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 15:02:04,322 - gemini_opa_grpo_job - INFO - Loaded gemini_rewards.py (13062 bytes)
2025-04-24 15:02:04,323 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (9992 bytes)
2025-04-24 15:02:04,323 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 15:02:04,323 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (2139 bytes)
2025-04-24 15:02:04,323 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (2462 bytes)
2025-04-24 15:02:04,324 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 15:02:06,788 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 353, in main
    config = create_grpo_config(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 172, in create_grpo_config
    reward_fns_config = RewardFunctionsConfig(
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
2025-04-24 16:30:59,548 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 16:30:59,549 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 16:30:59,550 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 16:30:59,550 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 16:30:59,550 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 16:30:59,551 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 16:30:59,552 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 16:30:59,552 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (19961 bytes)
2025-04-24 16:30:59,552 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 16:30:59,553 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (1922 bytes)
2025-04-24 16:30:59,554 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (1877 bytes)
2025-04-24 16:30:59,554 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 16:31:02,914 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 352, in main
    config = create_grpo_config(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 171, in create_grpo_config
    reward_fns_config = RewardFunctionsConfig(
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for RewardFunctionsConfig
functions.ahimsa
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_ahimsa_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
functions.dharma
  Input should be a valid dictionary or instance of RewardFunction [type=model_type, input_value='gemini_opa_dharma_reward', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/model_type
2025-04-24 16:31:40,714 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 16:31:40,714 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 16:31:40,715 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 16:31:40,715 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 16:31:40,716 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 16:31:40,716 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 16:31:40,717 - gemini_opa_grpo_job - INFO - Loading reward function code...
2025-04-24 16:31:40,720 - gemini_opa_grpo_job - INFO - Loaded gemini_opa_rewards.py (19961 bytes)
2025-04-24 16:31:40,720 - gemini_opa_grpo_job - INFO - Loading OPA policy code...
2025-04-24 16:31:40,721 - gemini_opa_grpo_job - INFO - Loaded custom/ahimsa.rego (1922 bytes)
2025-04-24 16:31:40,721 - gemini_opa_grpo_job - INFO - Loaded custom/dharma.rego (1877 bytes)
2025-04-24 16:31:40,722 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 16:31:45,203 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: could not get source code
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 355, in main
    config = create_grpo_config(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job.py", line 175, in create_grpo_config
    reward_fns_config = RewardFunctionsConfig(
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/config.py", line 127, in coerce_from_callable
    val = RewardFunction.from_callable(val).model_dump()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/config.py", line 145, in from_callable
    fn_source = inspect.getsource(fn)
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/inspect.py", line 1278, in getsource
    lines, lnum = getsourcelines(object)
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/inspect.py", line 1260, in getsourcelines
    lines, lnum = findsource(object)
                  ^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/inspect.py", line 1089, in findsource
    raise OSError('could not get source code')
OSError: could not get source code
2025-04-24 16:33:52,533 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 16:33:52,534 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 16:33:52,534 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 16:33:52,535 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 16:33:52,535 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 16:33:52,535 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 16:33:52,535 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 16:33:55,688 - gemini_opa_grpo_job - INFO - GRPO configuration created
2025-04-24 16:33:55,688 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa-test)...
2025-04-24 16:33:56,872 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 16:33:58,613 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: Bad request. Response status code 404. Error: {'message': 'Repo argen-gemini-opa-test not found'}
2025-04-24 16:33:58,614 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: Bad request. Response status code 404. Error: {'message': 'Repo argen-gemini-opa-test not found'}
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job_direct.py", line 716, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job_direct.py", line 597, in submit_grpo_job
    job = pb.finetuning.jobs.create(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/resources/finetuning_jobs.py", line 55, in create
    job_resp = self._client.http_post(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 166, in http_post
    return _to_json(do())
           ^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/predibase/_client.py", line 213, in _to_json
    raise RuntimeError(
RuntimeError: Bad request. Response status code 404. Error: {'message': 'Repo argen-gemini-opa-test not found'}
2025-04-24 16:34:33,317 - gemini_opa_grpo_job - INFO - Starting GRPO job script...
2025-04-24 16:34:33,318 - gemini_opa_grpo_job - INFO - Loading environment variables...
2025-04-24 16:34:33,320 - gemini_opa_grpo_job - INFO - Getting Gemini API key...
2025-04-24 16:34:33,320 - gemini_opa_grpo_job - INFO - Gemini API key found
2025-04-24 16:34:33,320 - gemini_opa_grpo_job - INFO - Getting Predibase API token...
2025-04-24 16:34:33,320 - gemini_opa_grpo_job - INFO - Predibase API token found
2025-04-24 16:34:33,321 - gemini_opa_grpo_job - INFO - Creating GRPO configuration for model llama-3-2-1b-instruct...
2025-04-24 16:34:36,589 - gemini_opa_grpo_job - INFO - GRPO configuration created
2025-04-24 16:34:36,589 - gemini_opa_grpo_job - INFO - Submitting GRPO job to Predibase (dataset: argen_combined_dataset, repo: argen-gemini-opa)...
2025-04-24 16:34:37,744 - gemini_opa_grpo_job - INFO - Connected to Predibase
2025-04-24 16:34:38,361 - gemini_opa_grpo_job - INFO - Repository argen-gemini-opa already exists
2025-04-24 16:34:40,391 - gemini_opa_grpo_job - ERROR - Error creating GRPO job: 'FinetuningJob' object has no attribute 'id'
2025-04-24 16:34:40,392 - gemini_opa_grpo_job - ERROR - Error in GRPO job script: 'FinetuningJob' object has no attribute 'id'
Traceback (most recent call last):
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job_direct.py", line 731, in main
    job = submit_grpo_job(
          ^^^^^^^^^^^^^^^^
  File "/home/kapil/Projects/argen-demo/scripts/run_gemini_opa_grpo_job_direct.py", line 619, in submit_grpo_job
    logger.info(f"GRPO job submitted successfully! Job ID: {job.id}")
                                                            ^^^^^^
  File "/home/kapil/Projects/argen-demo/.venv/lib/python3.12/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'FinetuningJob' object has no attribute 'id'
